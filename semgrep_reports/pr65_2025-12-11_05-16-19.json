{
  "version": "1.145.0",
  "results": [
    {
      "check_id": "python.lang.security.audit.subprocess-shell-true.subprocess-shell-true",
      "path": "pr_review.py",
      "start": {
        "line": 26,
        "col": 49,
        "offset": 768
      },
      "end": {
        "line": 26,
        "col": 53,
        "offset": 772
      },
      "extra": {
        "message": "Found 'subprocess' function 'call' with 'shell=True'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.",
        "fix": "False",
        "metadata": {
          "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b602_subprocess_popen_with_shell_equals_true.html",
          "owasp": [
            "A01:2017 - Injection",
            "A03:2021 - Injection"
          ],
          "cwe": [
            "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
          ],
          "references": [
            "https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess",
            "https://docs.python.org/3/library/subprocess.html"
          ],
          "category": "security",
          "technology": [
            "python"
          ],
          "cwe2022-top25": true,
          "cwe2021-top25": true,
          "subcategory": [
            "secure default"
          ],
          "likelihood": "HIGH",
          "impact": "LOW",
          "confidence": "MEDIUM",
          "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
          "vulnerability_class": [
            "Command Injection"
          ],
          "source": "https://semgrep.dev/r/python.lang.security.audit.subprocess-shell-true.subprocess-shell-true",
          "shortlink": "https://sg.run/J92w"
        },
        "severity": "ERROR",
        "fingerprint": "requires login",
        "lines": "requires login",
        "validation_state": "NO_VALIDATOR",
        "engine_kind": "OSS"
      }
    },
    {
      "check_id": "python.lang.security.audit.exec-detected.exec-detected",
      "path": "pr_review.py",
      "start": {
        "line": 38,
        "col": 5,
        "offset": 1089
      },
      "end": {
        "line": 38,
        "col": 20,
        "offset": 1104
      },
      "extra": {
        "message": "Detected the use of exec(). exec() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
        "metadata": {
          "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b102_exec_used.html",
          "cwe": [
            "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
          ],
          "owasp": [
            "A03:2021 - Injection"
          ],
          "asvs": {
            "control_id": "5.2.4 Dyanmic Code Execution Features",
            "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
            "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
            "version": "4"
          },
          "category": "security",
          "technology": [
            "python"
          ],
          "references": [
            "https://owasp.org/Top10/A03_2021-Injection"
          ],
          "subcategory": [
            "audit"
          ],
          "likelihood": "LOW",
          "impact": "HIGH",
          "confidence": "LOW",
          "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
          "vulnerability_class": [
            "Code Injection"
          ],
          "source": "https://semgrep.dev/r/python.lang.security.audit.exec-detected.exec-detected",
          "shortlink": "https://sg.run/ndRX"
        },
        "severity": "WARNING",
        "fingerprint": "requires login",
        "lines": "requires login",
        "validation_state": "NO_VALIDATOR",
        "engine_kind": "OSS"
      }
    },
    {
      "check_id": "python.lang.security.deserialization.pickle.avoid-pickle",
      "path": "pr_review.py",
      "start": {
        "line": 42,
        "col": 11,
        "offset": 1236
      },
      "end": {
        "line": 42,
        "col": 37,
        "offset": 1262
      },
      "extra": {
        "message": "Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.",
        "metadata": {
          "owasp": [
            "A08:2017 - Insecure Deserialization",
            "A08:2021 - Software and Data Integrity Failures"
          ],
          "cwe": [
            "CWE-502: Deserialization of Untrusted Data"
          ],
          "references": [
            "https://docs.python.org/3/library/pickle.html"
          ],
          "category": "security",
          "technology": [
            "python"
          ],
          "cwe2022-top25": true,
          "cwe2021-top25": true,
          "subcategory": [
            "audit"
          ],
          "likelihood": "LOW",
          "impact": "MEDIUM",
          "confidence": "LOW",
          "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
          "vulnerability_class": [
            "Insecure Deserialization "
          ],
          "source": "https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle",
          "shortlink": "https://sg.run/OPwB"
        },
        "severity": "WARNING",
        "fingerprint": "requires login",
        "lines": "requires login",
        "validation_state": "NO_VALIDATOR",
        "engine_kind": "OSS"
      }
    },
    {
      "check_id": "python.lang.security.deserialization.pickle.avoid-pickle",
      "path": "pr_review.py",
      "start": {
        "line": 61,
        "col": 13,
        "offset": 1806
      },
      "end": {
        "line": 61,
        "col": 41,
        "offset": 1834
      },
      "extra": {
        "message": "Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.",
        "metadata": {
          "owasp": [
            "A08:2017 - Insecure Deserialization",
            "A08:2021 - Software and Data Integrity Failures"
          ],
          "cwe": [
            "CWE-502: Deserialization of Untrusted Data"
          ],
          "references": [
            "https://docs.python.org/3/library/pickle.html"
          ],
          "category": "security",
          "technology": [
            "python"
          ],
          "cwe2022-top25": true,
          "cwe2021-top25": true,
          "subcategory": [
            "audit"
          ],
          "likelihood": "LOW",
          "impact": "MEDIUM",
          "confidence": "LOW",
          "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
          "vulnerability_class": [
            "Insecure Deserialization "
          ],
          "source": "https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle",
          "shortlink": "https://sg.run/OPwB"
        },
        "severity": "WARNING",
        "fingerprint": "requires login",
        "lines": "requires login",
        "validation_state": "NO_VALIDATOR",
        "engine_kind": "OSS"
      }
    }
  ],
  "errors": [
    {
      "code": 3,
      "level": "warn",
      "type": [
        "PartialParsing",
        [
          {
            "path": ".github/workflows/pr_reviewer.yml",
            "start": {
              "line": 46,
              "col": 26,
              "offset": 1019
            },
            "end": {
              "line": 46,
              "col": 50,
              "offset": 1043
            }
          },
          {
            "path": ".github/workflows/pr_reviewer.yml",
            "start": {
              "line": 47,
              "col": 21,
              "offset": 1019
            },
            "end": {
              "line": 47,
              "col": 55,
              "offset": 1053
            }
          }
        ]
      ],
      "message": "Syntax error at line .github/workflows/pr_reviewer.yml:46:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ secrets.GEMINI_API_KEY` was unexpected",
      "path": ".github/workflows/pr_reviewer.yml",
      "spans": [
        {
          "file": ".github/workflows/pr_reviewer.yml",
          "start": {
            "line": 46,
            "col": 26,
            "offset": 1019
          },
          "end": {
            "line": 46,
            "col": 50,
            "offset": 1043
          }
        },
        {
          "file": ".github/workflows/pr_reviewer.yml",
          "start": {
            "line": 47,
            "col": 21,
            "offset": 1019
          },
          "end": {
            "line": 47,
            "col": 55,
            "offset": 1053
          }
        }
      ]
    },
    {
      "code": 3,
      "level": "warn",
      "type": [
        "PartialParsing",
        [
          {
            "path": ".github/workflows/pr_reviewer.yml",
            "start": {
              "line": 70,
              "col": 26,
              "offset": 1494
            },
            "end": {
              "line": 70,
              "col": 60,
              "offset": 1528
            }
          },
          {
            "path": ".github/workflows/pr_reviewer.yml",
            "start": {
              "line": 73,
              "col": 46,
              "offset": 1494
            },
            "end": {
              "line": 73,
              "col": 80,
              "offset": 1528
            }
          }
        ]
      ],
      "message": "Syntax error at line .github/workflows/pr_reviewer.yml:70:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ github.event.pull_request.number` was unexpected",
      "path": ".github/workflows/pr_reviewer.yml",
      "spans": [
        {
          "file": ".github/workflows/pr_reviewer.yml",
          "start": {
            "line": 70,
            "col": 26,
            "offset": 1494
          },
          "end": {
            "line": 70,
            "col": 60,
            "offset": 1528
          }
        },
        {
          "file": ".github/workflows/pr_reviewer.yml",
          "start": {
            "line": 73,
            "col": 46,
            "offset": 1494
          },
          "end": {
            "line": 73,
            "col": 80,
            "offset": 1528
          }
        }
      ]
    }
  ],
  "paths": {
    "scanned": [
      ".github/workflows/pr_reviewer.yml",
      "README.md",
      "llm.py",
      "pr_review.py",
      "semgrep_reports/pr64_2025-12-10_06-18-42.json",
      "semgrep_reports/pr65_2025-12-11_04-48-40.json",
      "semgrep_reports/pr65_2025-12-11_05-06-15.json"
    ]
  },
  "time": {
    "rules": [],
    "rules_parse_time": 1.2317540645599365,
    "profiling_times": {
      "config_time": 1.7298951148986816,
      "core_time": 1.828998327255249,
      "ignores_time": 0.001377105712890625,
      "total_time": 3.560767889022827
    },
    "parsing_time": {
      "total_time": 0.0,
      "per_file_time": {
        "mean": 0.0,
        "std_dev": 0.0
      },
      "very_slow_stats": {
        "time_ratio": 0.0,
        "count_ratio": 0.0
      },
      "very_slow_files": []
    },
    "scanning_time": {
      "total_time": 0.28736424446105957,
      "per_file_time": {
        "mean": 0.014368212223052979,
        "std_dev": 0.000805482139209488
      },
      "very_slow_stats": {
        "time_ratio": 0.0,
        "count_ratio": 0.0
      },
      "very_slow_files": []
    },
    "matching_time": {
      "total_time": 0.0,
      "per_file_and_rule_time": {
        "mean": 0.0,
        "std_dev": 0.0
      },
      "very_slow_stats": {
        "time_ratio": 0.0,
        "count_ratio": 0.0
      },
      "very_slow_rules_on_files": []
    },
    "tainting_time": {
      "total_time": 0.0,
      "per_def_and_rule_time": {
        "mean": 0.0,
        "std_dev": 0.0
      },
      "very_slow_stats": {
        "time_ratio": 0.0,
        "count_ratio": 0.0
      },
      "very_slow_rules_on_defs": []
    },
    "fixpoint_timeouts": [],
    "prefiltering": {
      "project_level_time": 0.0,
      "file_level_time": 0.0,
      "rules_with_project_prefilters_ratio": 0.0,
      "rules_with_file_prefilters_ratio": 0.9491329479768786,
      "rules_selected_ratio": 0.06936416184971098,
      "rules_matched_ratio": 0.06936416184971098
    },
    "targets": [],
    "total_bytes": 0,
    "max_memory_bytes": 1137761024
  },
  "engine_requested": "OSS",
  "skipped_rules": [],
  "profiling_results": []
}
